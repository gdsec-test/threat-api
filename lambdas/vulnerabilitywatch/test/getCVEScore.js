const { expect } = require('chai');
const getCVEScore = require('../src/getCVEScore');

describe('Get CVE Score', function () {
  let item;
  beforeEach(() => {
    item = {
      impact: {
        baseMetricV3: { cvssV3: { baseScore: 5 } },
        baseMetricV2: { cvssV2: { baseScore: 8 } }
      }
    };
  });

  it('should return proper score from V3', function () {
    expect(getCVEScore(item)).to.equal(5);
  });

  it('should return proper score from V2 if V3 is not present', function () {
    delete item.impact.baseMetricV3.cvssV3.baseScore;
    expect(getCVEScore(item)).to.equal(8);
  });

  it('should return 0 if no score available', function () {
    expect(getCVEScore({})).to.equal(0);
  });
});
