function getCPEData(nodes = []) {
  let result = [];
  const nodes_arr = nodes.reduce((acc, { children = [], cpe_match = [] }) => {
    const cpes_arr = cpe_match.reduce((acc, { cpe23Uri }) => {
      acc.push('`' + cpe23Uri + '`');
      return acc;
    }, []);
    acc = [...acc, ...cpes_arr];
    acc = [...acc, ...getCPEData(children)];
    return acc;
  }, []);
  result = [...result, ...nodes_arr];
  return result;
}

module.exports = (CVEitem) => {
  const { configurations: { nodes = [] } = {} } = CVEitem;
  return getCPEData(nodes);
};
