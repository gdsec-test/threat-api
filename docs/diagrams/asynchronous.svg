<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="807px" preserveAspectRatio="none" style="width:1428px;height:807px;" version="1.1" viewBox="0 0 1428 807" width="1428px" zoomAndPan="magnify"><defs><filter height="300%" id="f1vgkzpswti65" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" height="795.498" style="stroke: #A80036; stroke-width: 1.0;" width="1127" x="189.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="738.5" y="18.5684">AWS</text><rect fill="#FFFFFF" height="795.498" style="stroke: #A80036; stroke-width: 1.0;" width="104" x="1318.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="1330" y="18.5684">Service Now</text><rect fill="#FFFFFF" filter="url(#f1vgkzpswti65)" height="87.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="560.5" y="294.6621"/><rect fill="#FFFFFF" filter="url(#f1vgkzpswti65)" height="146.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="949.5" y="511.1465"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="110" x2="110" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="217.5" x2="217.5" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="324.5" x2="324.5" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="444.5" x2="444.5" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="565.5" x2="565.5" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="702" x2="702" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="806" x2="806" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="954" x2="954" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1113" x2="1113" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1266.5" x2="1266.5" y1="88.4883" y2="715.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1370.5" x2="1370.5" y1="88.4883" y2="715.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="92" y="85.5352">User</text><ellipse cx="110.5" cy="15" fill="#FEFECE" filter="url(#f1vgkzpswti65)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M110.5,23 L110.5,50 M97.5,31 L123.5,31 M110.5,50 L97.5,65 M110.5,50 L123.5,65 " fill="none" filter="url(#f1vgkzpswti65)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="92" y="727.5449">User</text><ellipse cx="110.5" cy="740.498" fill="#FEFECE" filter="url(#f1vgkzpswti65)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M110.5,748.498 L110.5,775.498 M97.5,756.498 L123.5,756.498 M110.5,775.498 L97.5,790.498 M110.5,775.498 L123.5,790.498 " fill="none" filter="url(#f1vgkzpswti65)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="193.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="200.5" y="73.5352">WAF</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="193.5" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="200.5" y="734.5449">WAF</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="272.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="279.5" y="73.5352">API_Gateway</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="272.5" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="279.5" y="734.5449">API_Gateway</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="386.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="393.5" y="73.5352">JWT_Autorizor</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="386.5" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="393.5" y="734.5449">JWT_Autorizor</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="512.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="519.5" y="73.5352">Job_Spawner</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="512.5" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="519.5" y="734.5449">Job_Spawner</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="671" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="678" y="73.5352">Queue</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="671" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="678" y="734.5449">Queue</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="744" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="751" y="73.5352">Router_Lambda</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="744" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="751" y="734.5449">Router_Lambda</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="147" x="879" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="133" x="886" y="73.5352">Requested_Lambda</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="147" x="879" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="133" x="886" y="734.5449">Requested_Lambda</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="1076" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="1083" y="73.5352">Asherah</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="1076" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="1083" y="734.5449">Asherah</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="1220.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="1227.5" y="73.5352">DynamoDB</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="1220.5" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="1227.5" y="734.5449">DynamoDB</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1322.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1329.5" y="73.5352">ServiceNow</text><rect fill="#FEFECE" filter="url(#f1vgkzpswti65)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1322.5" y="714.0098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1329.5" y="734.5449">ServiceNow</text><rect fill="#FFFFFF" filter="url(#f1vgkzpswti65)" height="87.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="560.5" y="294.6621"/><rect fill="#FFFFFF" filter="url(#f1vgkzpswti65)" height="146.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="949.5" y="511.1465"/><polygon fill="#A80036" points="205.5,115.7988,215.5,119.7988,205.5,123.7988,209.5,119.7988" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="110.5" x2="211.5" y1="119.7988" y2="119.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="117.5" y="115.0566">POST request</text><polygon fill="#A80036" points="312.5,145.1094,322.5,149.1094,312.5,153.1094,316.5,149.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="217.5" x2="318.5" y1="149.1094" y2="149.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="224.5" y="144.3672">POST request</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="324.5" x2="366.5" y1="193.7305" y2="193.7305"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="366.5" x2="366.5" y1="193.7305" y2="206.7305"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="325.5" x2="366.5" y1="206.7305" y2="206.7305"/><polygon fill="#A80036" points="335.5,202.7305,325.5,206.7305,335.5,210.7305,331.5,206.7305" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="331.5" y="173.6777">Validate request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="335.5" y="188.9883">and parameters</text><polygon fill="#A80036" points="432.5,232.041,442.5,236.041,432.5,240.041,436.5,236.041" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="324.5" x2="438.5" y1="236.041" y2="236.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="331.5" y="231.2988">Check JWT</text><polygon fill="#A80036" points="335.5,261.3516,325.5,265.3516,335.5,269.3516,331.5,265.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="329.5" x2="443.5" y1="265.3516" y2="265.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="341.5" y="260.6094">JWT good</text><polygon fill="#A80036" points="548.5,290.6621,558.5,294.6621,548.5,298.6621,552.5,294.6621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="324.5" x2="554.5" y1="294.6621" y2="294.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="331.5" y="289.9199">Path and parameters</text><polygon fill="#A80036" points="1254.5,319.9727,1264.5,323.9727,1254.5,327.9727,1258.5,323.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="570.5" x2="1260.5" y1="323.9727" y2="323.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="577.5" y="319.2305">Store job_id</text><polygon fill="#A80036" points="690.5,349.2832,700.5,353.2832,690.5,357.2832,694.5,353.2832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="570.5" x2="696.5" y1="353.2832" y2="353.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="577.5" y="348.541">Add job to queue</text><polygon fill="#A80036" points="121.5,378.5938,111.5,382.5938,121.5,386.5938,117.5,382.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="115.5" x2="564.5" y1="382.5938" y2="382.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="127.5" y="377.8516">job_id</text><path d="M5,395.5938 L5,450.5938 L213,450.5938 L213,405.5938 L203,395.5938 L5,395.5938 " fill="#FBFB77" filter="url(#f1vgkzpswti65)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M203,395.5938 L203,405.5938 L213,405.5938 L203,395.5938 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="11" y="413.1621">At this point the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="15" y="428.4727">request is done and the user</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="15" y="443.7832">must poll for the result</text><polygon fill="#A80036" points="794.5,477.8359,804.5,481.8359,794.5,485.8359,798.5,481.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="702.5" x2="800.5" y1="481.8359" y2="481.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="709.5" y="477.0938">invokes</text><polygon fill="#A80036" points="937.5,507.1465,947.5,511.1465,937.5,515.1465,941.5,511.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="806.5" x2="943.5" y1="511.1465" y2="511.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="813.5" y="506.4043">invokes</text><polygon fill="#A80036" points="1358.5,536.457,1368.5,540.457,1358.5,544.457,1362.5,540.457" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="959.5" x2="1364.5" y1="540.457" y2="540.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="966.5" y="535.7148">API Call (With JWT)</text><polygon fill="#A80036" points="970.5,565.7676,960.5,569.7676,970.5,573.7676,966.5,569.7676" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="964.5" x2="1369.5" y1="569.7676" y2="569.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="976.5" y="565.0254">Response</text><polygon fill="#A80036" points="1254.5,595.0781,1264.5,599.0781,1254.5,603.0781,1258.5,599.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="959.5" x2="1260.5" y1="599.0781" y2="599.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="199" x="966.5" y="594.3359">Update request_status to DONE</text><polygon fill="#A80036" points="1101.5,624.3887,1111.5,628.3887,1101.5,632.3887,1105.5,628.3887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="959.5" x2="1107.5" y1="628.3887" y2="628.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="966.5" y="623.6465">Store request results</text><polygon fill="#A80036" points="1254.5,653.6992,1264.5,657.6992,1254.5,661.6992,1258.5,657.6992" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1113.5" x2="1260.5" y1="657.6992" y2="657.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="1120.5" y="652.957">Store encrypted data</text><path d="M914,670.6992 L914,695.6992 L990,695.6992 L990,680.6992 L980,670.6992 L914,670.6992 " fill="#FBFB77" filter="url(#f1vgkzpswti65)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M980,670.6992 L980,680.6992 L990,680.6992 L980,670.6992 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="920" y="688.2676">Job done</text><!--MD5=[3c041ef58e9ad9986f9e64d9b9ed2a54]
@startuml "Asynchronous"
actor User
box "AWS" #LightBlue
User -> WAF : POST request
WAF -> API_Gateway : POST request
API_Gateway -> API_Gateway : Validate request \n and parameters
API_Gateway -> JWT_Autorizor: Check JWT
JWT_Autorizor -> API_Gateway: JWT good
API_Gateway -> Job_Spawner : Path and parameters
activate Job_Spawner
Job_Spawner -> DynamoDB : Store job_id
Job_Spawner -> Queue : Add job to queue
Job_Spawner -> User : job_id
deactivate Job_Spawner
note over User : At this point the \n request is done and the user \n must poll for the result
Queue -> Router_Lambda : invokes
Router_Lambda -> Requested_Lambda : invokes
activate Requested_Lambda
participant Asherah
database DynamoDB
end box
box "Service Now" #LightRed
Requested_Lambda -> ServiceNow : API Call (With JWT)
ServiceNow -> Requested_Lambda : Response
Requested_Lambda -> DynamoDB : Update request_status to DONE
Requested_Lambda -> Asherah : Store request results
Asherah -> DynamoDB : Store encrypted data
note over Requested_Lambda : Job done
deactivate Requested_Lambda
end box
@enduml

PlantUML version 1.2020.18(Wed Sep 30 15:40:44 EDT 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
